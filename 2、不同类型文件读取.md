## 表格数据

```python
import pandas as pd 

dftrain_raw = pd.read_csv('./eat_pytorch_datasets/titanic/train.csv')
dftest_raw = pd.read_csv('./eat_pytorch_datasets/titanic/test.csv')
```

## 图像数据

```python
from torchvision import transforms as T
from torchvision import datasets 

transform_img = T.Compose(
    [T.ToTensor()])

def transform_label(x):
    return torch.tensor([x]).float()


ds_train = datasets.ImageFolder("./eat_pytorch_datasets/cifar2/train/",
            transform = transform_img,target_transform = transform_label)
ds_val = datasets.ImageFolder("./eat_pytorch_datasets/cifar2/test/",
            transform = transform_img,target_transform = transform_label)
```

### 1. `from torchvision import transforms as T`

`torchvision.transforms` 是一个用来进行图像预处理的模块，提供了多种常用的图像转换操作。我们通过 `T` 来简化代码中的调用。

```python
from torchvision import transforms as T
```

### 2. `T.Compose([T.ToTensor()])`

`T.Compose` 是一个容器，用于将多个图像转换操作组合成一个流水线，以便依次应用每个转换。在这里，我们用 `T.Compose` 组合了一个单一的转换：`T.ToTensor()`。

#### `T.Compose` 用法

`T.Compose` 允许你将多个转换按顺序链式应用于图像。在应用于数据集时，它会依次对每张图片进行转换。

**示例**：

```python
transform = T.Compose([
    T.Resize(256),    # 将图像大小调整为 256x256
    T.CenterCrop(224), # 从中心裁剪出 224x224 的区域
    T.ToTensor(),     # 将图片转换为 Tensor
    T.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])  # 归一化
])
```

- `T.Resize(256)`：将图片的短边调整为 256px，长边按比例缩放。
- `T.CenterCrop(224)`：裁剪图片中心的 224x224 区域。
- `T.ToTensor()`：将图片从 `PIL` 或 `numpy` 数组格式转换为 `Tensor`，并将像素值归一化到 `[0, 1]` 范围。
- `T.Normalize(mean, std)`：对 Tensor 图像进行归一化处理，使得每个通道的均值为 `mean`，标准差为 `std`。

#### `T.ToTensor` 用法

`T.ToTensor()` 会将输入的图片转换为一个 `torch.Tensor`，并且它会将图片的像素值归一化到 `[0, 1]` 范围内。

**示例**：

```python
from PIL import Image
image = Image.open("example.jpg")
tensor_image = T.ToTensor()(image)
```

- 输入：`PIL` 图像或 `numpy` 数组。
- 输出：`torch.Tensor`，形状为 `(C, H, W)`，`C` 是通道数，`H` 是高度，`W` 是宽度。

### 3. `def transform_label(x): return torch.tensor([x]).float()`

这个函数用于将类别标签 `x` 转换为浮动型的 tensor。在分类任务中，标签通常是整数类型，但我们可能需要将其转换为浮动类型 tensor，特别是当进行某些损失计算或与网络输出对比时。

#### `torch.tensor` 用法

`torch.tensor` 是 PyTorch 中的一个基础方法，用于从 Python 列表、数组、numpy 数组等数据结构创建 tensor。

**示例**：

```python
label = 2  # 假设标签是 2
tensor_label = torch.tensor([label]).float()
```

- `torch.tensor([x])`：将数字 `x` 包装成一个 tensor。这里的 `[x]` 会将其变为一个包含 `x` 的列表，从而创建一个一维 tensor。
- `.float()`：将 tensor 转换为浮动类型 (`float32`)，以确保在计算时使用浮动数据类型。

输出结果为：

```python
tensor_label = tensor([2.])
```

### 4. `datasets.ImageFolder`

`datasets.ImageFolder` 是一个 PyTorch 的数据集类，用于从文件夹中加载图像数据。它假设文件夹的结构如下：

```
root/dog/xxx.png
root/cat/yyy.png
```

每个子文件夹名会被视为该文件夹下图片的标签。

#### `ImageFolder` 用法

`datasets.ImageFolder` 用于从磁盘上加载图像数据集，并且自动为每个文件夹分配标签。

**示例**：

```python
from torchvision import datasets

# 定义数据集路径
train_dataset = datasets.ImageFolder(root='./data/train', transform=transform_img, target_transform=transform_label)
```

- `root`：数据集所在的根目录。
- `transform`：图像转换操作，通常使用 `T.Compose` 对图像进行预处理（例如缩放、裁剪、归一化等）。
- `target_transform`：标签转换操作，将图像标签转换为所需的格式。在这里，我们使用 `transform_label` 将标签转换为浮动类型 tensor。

#### 数据加载

通过 `ImageFolder` 创建的数据集对象，具有以下属性：

- `.imgs`：包含图像文件路径和标签的列表。
- `.targets`：图像对应的标签列表。

**获取一张图片和标签**：

```python
img, label = train_dataset[0]  # 获取第一张图片和标签
print(img.shape)  # 输出图片的尺寸，如 [3, 224, 224]
print(label)      # 输出标签，如 0 或 1
```

### 5. 数据集分配

- `ds_train = datasets.ImageFolder("./eat_pytorch_datasets/cifar2/train/", transform=transform_img, target_transform=transform_label)`
   这行代码加载了训练集数据，图像经过 `transform_img` 转换（`T.ToTensor()`），标签经过 `transform_label` 转换（转为浮动型 tensor）。
- `ds_val = datasets.ImageFolder("./eat_pytorch_datasets/cifar2/test/", transform=transform_img, target_transform=transform_label)`
   这行代码加载了验证集数据，同样应用了图像和标签转换。

### 总结

#### 各函数的功能：

- `T.Compose`：将多个图像转换操作组合成一个转换流水线。
- `T.ToTensor`：将图像从 PIL 或 numpy 数组格式转换为 PyTorch 的 tensor 格式，并将像素值归一化到 `[0, 1]`。
- `torch.tensor`：将标签转换为 tensor 格式。
- `datasets.ImageFolder`：从目录中加载图像数据，自动将文件夹名称作为标签，并将每个图像和标签组合在一起。

#### 代码流程：

1. 图像经过 `T.ToTensor()` 转换为 tensor 格式。
2. 标签通过自定义的 `transform_label` 函数转换为浮动型的 tensor。
3. 使用 `datasets.ImageFolder` 加载训练集和验证集图像数据，并将转换应用到数据集中。

这样，数据就可以方便地用于后续的训练或验证过程。

## 文本数据

```python
dftrain = pd.read_csv("./eat_pytorch_datasets/imdb/train.tsv",sep="\t",header = None,names = ["label","text"])
dfval = pd.read_csv("./eat_pytorch_datasets/imdb/test.tsv",sep="\t",header = None,names = ["label","text"])
```

